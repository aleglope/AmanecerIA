# Walkthrough - Core Features & Premium Implementation

This document outlines the verification steps for the implemented core features (Preferences, Reactivity, Persistence) and the new premium features (Streak, Mood Charts, Exercises).

## 1. User Preferences & Reactivity

- [ ] **Tone & Length:** Go to Settings -> Notifications. Change Tone to 'Witty' and Length to 'Short'.
- [ ] **Verify:** Return to Dashboard. Log a mood. The AI response should be shorter and wittier.
- [ ] **Mood Reaction:** Log a specific mood (e.g., 'Sad').
- [ ] **Verify:** The MessageCard should immediately update with a supportive message relevant to 'Sad'.

## 2. Chat Persistence

- [ ] **Send Message:** Go to Chat. Send a message "Hello, how are you?".
- [ ] **Verify:** The message and AI response appear in the chat window.
- [ ] **Reload:** Refresh the page.
- [ ] **Verify:** The chat history is loaded and displayed correctly.
- [ ] **Database:** Check Supabase `chat_messages` table to confirm rows are inserted.

## 3. Streak Tracking

- [ ] **Check Header:** Look at the Profile Header on the Dashboard.
- [ ] **Verify:** A fire icon (ðŸ”¥) and streak count should be visible if you have logged a mood today or yesterday.
- [ ] **Increment:** Log a mood for today if you haven't already. The streak should update (or stay same if already logged today).

## 4. Mood Charts (Premium Feature)

- [ ] **Free User:** Log in as a non-premium user.
- [ ] **Verify:** The Mood History section shows a blurred chart with a "Unlock Trends" overlay.
- [ ] **Premium User:** Log in as a premium user (or toggle premium in DB).
- [ ] **Verify:** The Mood History section shows a clear, interactive area chart of your recent moods.

## 5. Exercise Library

- [ ] **Navigation:** Click the "Exercises" (ðŸ§˜) button on the Dashboard.
- [ ] **Verify:** You are taken to the Exercises page.
- [ ] **List:** You see a list of exercises (Box Breathing, 5-4-3-2-1, etc.).
- [ ] **Details:** Click on an exercise card.
- [ ] **Verify:** A modal opens with the exercise details and instructions.

## 6. Database Migration (Required)

You must run the following SQL in your Supabase SQL Editor to create the chat table:

```sql
create table if not exists public.chat_messages (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users not null,
  role text not null check (role in ('user', 'model')),
  content text not null,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

alter table public.chat_messages enable row level security;

create policy "Users can view their own chat messages"
  on public.chat_messages for select
  using (auth.uid() = user_id);

create policy "Users can insert their own chat messages"
  on public.chat_messages for insert
  with check (auth.uid() = user_id);
```
